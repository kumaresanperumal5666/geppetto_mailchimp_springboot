/**
 *
 * @author Schubert Generated Code</br>
 * Date Created: </br>
 * @since  </br>
   build:   </p>
 *
 * code was generated by the Schubert System </br>
 * Schubert system Copyright - NewPortBay LLC copy_right_range</br>
 * The generated code is free to use by anyone</p>
 *
 *
 *
*/

app.controller("Survey_result_Default_Activity", [ '$scope', '$rootScope', '$location', '$window', '$q', '$http', 'Servey_resultId ', 'RestURL',
				    function( $scope, $rootScope, $location, $window, $q, $http, Servey_resultId , RestURL) {

	
		$scope.Servey_result = {
		id: '',
		question_id : '', 
		option_id : '', 
		client_id : '', 
		product_id : '', 
		country_id : '', 
		survey_id : '', 
		user_id : ''
		};
		
		$scope.init = function () {
			$scope.getAllSurveys();
		}
		
		$scope.survey_list = "";
		
		$scope.getAllSurveys = function () {
			$http.get( RestURL.baseURL+'Survey_Default_Activity/get_Surveys').success(function(response) {
        		$scope.survey_list = response;
        		//console.log("response -> "+JSON.stringify(response));
        		
        	}).error(function(err) {
   		  	 alert('You got' + err + 'error');
  		  });
        };
        
        $scope.survey = null;
		
		$scope.getSurveyResult = function () {
			//console.log("Product -> getSurveyResult -> $scope.survey: " + JSON.stringify( $scope.survey.id ));
			
			$http.get( RestURL.baseURL+'Survey_Default_Activity/survey_result/'+ $scope.survey.id).success(function(response) {
        		$scope.survey_result = response;
        		//console.log("survey_result" + JSON.stringify(response) );
        		
        	}).error(function(err) {
   		  	 alert('You got' + err + 'error');
  		  });
        };
        
        $scope.showAnswerImage = function(answerText, answerOption) {
        	if (answerOption != undefined && answerOption != null) {
        		
        		if (answerOption.answer_type == "IMAGE_OPTIONS") {
        			return true;
        		}
        		
        	} else if (answerText != undefined && answerText !== null && answerText.startsWith("data:image")) {
        		return true;
        	}
        	
        	return false;
        }
        
        $scope.getAnswerImage = function (answerText, answerOption) {
        	//console.log("src/Survey_result_Deffault_Activity.js -> getAnswerImage -> Option -> "+ JSON.stringify(answerOption));
        	//console.log("src/Survey_result_Deffault_Activity.js -> getAnswerImage -> Answer -> "+ JSON.stringify(answerText));
        	if (answerOption != undefined && answerOption != null) {
        		
        		if (answerOption.answer_type == "IMAGE_OPTIONS") {
        			return answerOption.answer;
        		}
        		
        	} else if (answerText != undefined && answerText !== null && answerText.startsWith("data:image")) {
        		return answerText;
        	}
        	
        	return "assets/img/transparent.gif";
        }
        
        $scope.search = function () {

		  //this is where the start code goes
		  	$scope.Servey_result.question_id = $scope.Servey_result.question_id? $scope.Servey_result.question_id:"%%";
		  	$scope.Servey_result.option_id = $scope.Servey_result.option_id? $scope.Servey_result.option_id:"%%";
		  	$scope.Servey_result.client_id = $scope.Servey_result.client_id? $scope.Servey_result.client_id:"%%";
		  	$scope.Servey_result.product_id = $scope.Servey_result.product_id? $scope.Servey_result.product_id:"%%";
		  	$scope.Servey_result.country_id = $scope.Servey_result.country_id? $scope.Servey_result.country_id:"%%";
		  	$scope.Servey_result.survey_id = $scope.Servey_result.survey_id? $scope.Servey_result.survey_id:"%%";
		  	$scope.Servey_result.user_id = $scope.Servey_result.user_id? $scope.Servey_result.user_id:"%%";


		  //this is where the validate code goes

		  //this is where the confirm code goes

		  var deferred = $q.defer();
		  $http.get(RestURL.baseURL+'Survey_result_Default_Activity/search_Servey_result?question_id='+$scope.Servey_result.question_id+'&option_id='+$scope.Servey_result.option_id+'&client_id='+$scope.Servey_result.client_id+'&product_id='+$scope.Servey_result.product_id+'&country_id='+$scope.Servey_result.country_id+'&survey_id='+$scope.Servey_result.survey_id+'&user_id='+$scope.Servey_result.user_id).success(function(response) {
		  var search_result = [];
		  response.forEach(function(entry) {
		  var row = {'question_id':entry.question_id,'option_id':entry.option_id,'client_id':entry.client_id,'product_id':entry.product_id,'country_id':entry.country_id,'survey_id':entry.survey_id,'user_id':entry.user_id};
		  search_result.push(row);
		  });
		  handle_search_result(search_result);
		  }).error(function(err) {
		  alert('You got' + err + 'error');
		  deferred.reject(err);
		  });

		  //this is where the server response code goes

		  //this is where the display server response code goes

		  //this is where the transition code goes

		  //this is where the end code goes 
		  return deferred.promise; 


        };

        $scope.init();


		/*var id = Servey_resultId.getId();
		if (id) {
		console.log(id);
		$scope.search_for_update(id);
		} else {
		$('#myModal').modal('toggle');
		$('#myModal').modal('show');
		$scope.searchForServey_result = function () {
		if ($scope.idForServey_result) {
		$('#myModal').modal('hide');
		id = $scope.idForServey_result;
		console.log(id);
		$scope.search_for_update(id);
		}	else {
		alert('You should enter ID');
		}
		};
		}*/

		$scope.$on('$viewContentLoaded', function(event) {
			var biggestHeight = 0;
			var height = 0;
			$(".screen").find('*').each(function(){
				height = $(this).position().top + $(this).height() + 100;
				if (height > biggestHeight ) {
					biggestHeight = height;
				}
			});
			$(".screen").height(biggestHeight);
		});

}]);


